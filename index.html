<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earth 3D Map - Explore the World</title>
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.95/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.95/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
    <div id="toolbar">
        <select id="mapStyle">
            <option value="satellite" selected>Satellite</option>
            <option value="terrain">Terrain</option>
        </select>
        <select id="languageSelector">
            <option value="en" selected>English</option>
            <option value="fr">Fran√ßais</option>
            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
        </select>
    </div>
    
    <div id="layerControl">
        <h4>Layers</h4>
        <label><input type="checkbox" id="toggleBorders" checked> Country Borders</label>
        <label><input type="checkbox" id="toggleLabels" checked> Country Labels</label>
        <label><input type="checkbox" id="toggleCities" checked> City Labels</label>
        <div class="slider-control">
            <label>Imagery Opacity</label>
            <input type="range" id="imageryOpacity" min="0" max="100" value="100">
            <span id="opacityValue">100%</span>
        </div>
    </div>
    
    <div id="bookmarksPanel">
        <h4>Bookmarks</h4>
        <button id="saveViewBtn">üíæ Save Current View</button>
        <div id="bookmarksList"></div>
    </div>
    
    <div id="loadingScreen" class="loading-active">
        <div class="loading-container">
            <div class="earth-loader">
                <div class="earth-sphere">
                    <div class="earth-glow"></div>
                </div>
                <div class="loading-ring"></div>
            </div>
            <h2>Loading Earth 3D Map</h2>
            <p class="loading-status">Initializing Cesium viewer...</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <p class="loading-text">Fetching satellite imagery, borders, and terrain data</p>
        </div>
    </div>
    
    <div id="cesiumContainer"></div>
    
    <div id="infoPanel" class="hidden">
        <div id="infoPanelContent">
            <button id="closeInfoPanel">&times;</button>
            <h3 id="locationTitle"></h3>
            <p id="locationDescription"></p>
            <div id="locationDetails"></div>
        </div>
    </div>
    
    <div id="energySidePanel">
        <h3 id="panelTitle">Tunisia Energy Data</h3>
        <div id="countrySelector">
            <label for="energyCountry">Country: </label>
            <select id="energyCountry">
                <option value="tunisia" selected>Tunisia</option>
                <option value="algeria">Algeria</option>
                <option value="morocco">Morocco</option>
                <option value="libya">Libya</option>
            </select>
        </div>
        <div id="yearSelector">
            <label for="energyYear">Year: </label>
            <select id="energyYear"></select>
        </div>
        <div id="timeControls">
            <button id="playBtn" title="Play animation">‚ñ∂</button>
            <button id="pauseBtn" title="Pause animation" style="display:none;">‚è∏</button>
            <input type="range" id="yearSlider" min="2000" max="2035" value="2025" step="1">
            <span id="sliderYear">2025</span>
        </div>
        <button id="toggleMapViz" class="viz-toggle-btn">üìä Show Map Visualization</button>
        
        <!-- AI Prediction Info -->
        <div id="predictionInfo" style="display:none; margin: 12px 0; padding: 10px; background: rgba(0, 255, 255, 0.1); border: 1px solid rgba(0, 255, 255, 0.3); border-radius: 6px;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                <strong style="color: #00ffff; font-size: 11px;">AI PREDICTION MODEL</strong>
            </div>
            <p style="font-size: 9px; color: #94a3b8; margin: 0 0 8px 0; line-height: 1.4;">
                <strong>Deterministic mathematical projections</strong> based on historical trends, growth rates, and field-specific models. No randomness - results are consistent and reproducible.
            </p>
            <div style="font-size: 8px; color: #64748b; margin-bottom: 8px; padding: 6px; background: rgba(0, 0, 0, 0.2); border-radius: 3px;">
                <strong style="color: #94a3b8;">Models Used:</strong><br>
                ‚Ä¢ Linear Regression (trend analysis)<br>
                ‚Ä¢ Exponential Growth (recent momentum)<br>
                ‚Ä¢ Logistic S-Curve (renewable adoption)<br>
                ‚Ä¢ Hubbert Curve (resource depletion)<br>
                ‚Ä¢ Correlation Models (CO2, Investment)
            </div>
            <button id="refreshPredictionBtn" style="width: 100%; padding: 6px; background: rgba(0, 255, 255, 0.15); border: 1px solid rgba(0, 255, 255, 0.4); border-radius: 4px; color: #00ffff; font-size: 10px; cursor: pointer; transition: all 0.2s;">
                üîÑ Recalculate Predictions
            </button>
            <div style="margin-top: 8px; font-size: 8px; color: #64748b;">
                Calculated: <span id="predictionTimestamp">--:--:--</span>
            </div>
        </div>
        
        <!-- Inline Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">POPULATION</div>
                <div class="stat-value" id="stat-population">-</div>
                <div class="stat-unit">million</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">GDP</div>
                <div class="stat-value" id="stat-gdp">-</div>
                <div class="stat-unit">billion USD</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ENERGY CONSUMPTION</div>
                <div class="stat-value" id="stat-consumption">-</div>
                <div class="stat-unit">MTEP</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">OIL PRODUCTION</div>
                <div class="stat-value" id="stat-oil">-</div>
                <div class="stat-unit">M barrels</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">GAS PRODUCTION</div>
                <div class="stat-value" id="stat-gas">-</div>
                <div class="stat-unit">billion m¬≥</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ELECTRICITY PRODUCTION</div>
                <div class="stat-value" id="stat-electricity">-</div>
                <div class="stat-unit">TWh</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">RENEWABLE ENERGY SHARE</div>
                <div class="stat-value" id="stat-renewable">-</div>
                <div class="stat-unit">%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">OIL RESERVES</div>
                <div class="stat-value" id="stat-oilReserves">-</div>
                <div class="stat-unit">M barrels</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">GAS RESERVES</div>
                <div class="stat-value" id="stat-gasReserves">-</div>
                <div class="stat-unit">billion m¬≥</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ENERGY IMPORTS</div>
                <div class="stat-value" id="stat-energyImports">-</div>
                <div class="stat-unit">MTEP</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ENERGY EXPORTS</div>
                <div class="stat-value" id="stat-energyExports">-</div>
                <div class="stat-unit">MTEP</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">CO2 EMISSIONS</div>
                <div class="stat-value" id="stat-co2">-</div>
                <div class="stat-unit">M tonnes</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">INVESTMENT</div>
                <div class="stat-value" id="stat-investment">-</div>
                <div class="stat-unit">million USD</div>
            </div>
        </div>
    </div>
    
    <div id="mapVisualization" class="hidden">
        <div class="viz-header">
            <h3>Tunisia Energy Overview <span id="vizYear">2025</span></h3>
            <button id="closeMapViz">&times;</button>
        </div>
        <div class="viz-grid">
            <div class="viz-card">
                <div class="viz-title">Energy Production</div>
                <canvas id="productionChart" width="120" height="90"></canvas>
            </div>
            <div class="viz-card">
                <div class="viz-title">Renewable Transition</div>
                <canvas id="renewableChart" width="120" height="90"></canvas>
            </div>
            <div class="viz-card">
                <div class="viz-title">Energy Balance</div>
                <canvas id="balanceChart" width="120" height="90"></canvas>
            </div>
            <div class="viz-card">
                <div class="viz-title">Economic Indicators</div>
                <div class="indicator-group">
                    <div class="indicator-item">
                        <span class="indicator-label">Population</span>
                        <span class="indicator-value" id="vizPop">-</span>
                        <span class="indicator-trend" id="trendPop"></span>
                    </div>
                    <div class="indicator-item">
                        <span class="indicator-label">GDP</span>
                        <span class="indicator-value" id="vizGDP">-</span>
                        <span class="indicator-trend" id="trendGDP"></span>
                    </div>
                    <div class="indicator-item">
                        <span class="indicator-label">Investment</span>
                        <span class="indicator-value" id="vizInvest">-</span>
                        <span class="indicator-trend" id="trendInvest"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="heatmapPanel" class="carousel-container">
        <div style="position: fixed; top: 20px; right: 20px; width: 280px; z-index: 1001; background: rgba(15, 23, 42, 0.35); padding: 12px; border-radius: 12px; backdrop-filter: blur(8px); border: 1px solid rgba(0, 255, 255, 0.15); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2); max-height: calc(100vh - 60px); overflow-y: auto;">
            <h4 style="color: #ff6b6b; margin: 0 0 10px 0; padding-bottom: 6px; border-bottom: 2px solid rgba(255, 107, 107, 0.3); font-size: 12px; text-transform: uppercase; font-weight: 600; letter-spacing: 0.5px;">üî• Heatmap</h4>
        
        <!-- Countries (Compact) -->
        <div style="margin-bottom: 10px;">
            <label style="font-size: 11px; font-weight: 600; color: #4fc3f7; display: block; margin-bottom: 6px;">Countries</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
                <label style="font-size: 10px; display: flex; align-items: center; gap: 4px; cursor: pointer;">
                    <input type="checkbox" id="tunisiaCheck" data-country="tunisia" checked style="cursor: pointer; width: 14px; height: 14px;">
                    Tunisia
                </label>
                <label style="font-size: 10px; display: flex; align-items: center; gap: 4px; cursor: pointer;">
                    <input type="checkbox" id="algeriaCheck" data-country="algeria" style="cursor: pointer; width: 14px; height: 14px;">
                    Algeria
                </label>
                <label style="font-size: 10px; display: flex; align-items: center; gap: 4px; cursor: pointer;">
                    <input type="checkbox" id="moroccoCheck" data-country="morocco" style="cursor: pointer; width: 14px; height: 14px;">
                    Morocco
                </label>
                <label style="font-size: 10px; display: flex; align-items: center; gap: 4px; cursor: pointer;">
                    <input type="checkbox" id="libyaCheck" data-country="libya" style="cursor: pointer; width: 14px; height: 14px;">
                    Libya
                </label>
            </div>
        </div>
        
        <!-- Metric Selector -->
        <div style="margin-bottom: 10px;">
            <label for="metricSelect" style="font-size: 11px; font-weight: 600; color: #4fc3f7; display: block; margin-bottom: 4px;">Metric</label>
            <select id="metricSelect" style="width: 100%; padding: 6px; font-size: 10px; background: rgba(30, 41, 59, 0.6); color: #4fc3f7; border: 1px solid rgba(79, 195, 247, 0.25); border-radius: 4px; cursor: pointer; transition: all 0.2s;">
                <option value="population">Population</option>
                <option value="gdp">GDP</option>
                <option value="energyConsumption">Energy Consumption</option>
                <option value="oilProduction">Oil Production</option>
                <option value="gasProduction">Gas Production</option>
                <option value="electricityProduction">Electricity</option>
                <option value="renewableShare">Renewable %</option>
                <option value="co2Emissions">CO2 Emissions</option>
            </select>
        </div>
        
        <!-- Year Selector -->
        <div style="margin-bottom: 10px;">
            <label for="heatmapYear" style="font-size: 11px; font-weight: 600; color: #4fc3f7; display: block; margin-bottom: 4px;">Year</label>
            <select id="heatmapYear" style="width: 100%; padding: 6px; font-size: 10px; background: rgba(30, 41, 59, 0.6); color: #4fc3f7; border: 1px solid rgba(79, 195, 247, 0.25); border-radius: 4px; cursor: pointer; transition: all 0.2s;">
                <option value="2000">2000</option>
                <option value="2005">2005</option>
                <option value="2010">2010</option>
                <option value="2015">2015</option>
                <option value="2020">2020</option>
                <option value="2023">2023</option>
                <option value="2024">2024*</option>
                <option value="2025" selected>2025*</option>
                <option value="2030" style="color: #00ffff;">2030 [AI]</option>
                <option value="2035" style="color: #00ffff;">2035 [AI]</option>
            </select>
        </div>
        
        <!-- Opacity Slider -->
        <div style="margin-bottom: 10px;">
            <label for="heatmapOpacitySlider" style="font-size: 11px; font-weight: 600; color: #4fc3f7; display: flex; justify-content: space-between; margin-bottom: 4px;">
                <span>Opacity</span>
                <span id="heatmapOpacityValue" style="color: #00ffff;">70%</span>
            </label>
            <input type="range" id="heatmapOpacitySlider" min="0" max="100" value="70" style="width: 100%; height: 4px; cursor: pointer; accent-color: #4fc3f7;">
        </div>
        
        <!-- Show/Hide Button -->
        <button id="toggleHeatmapBtn" style="width: 100%; padding: 8px 12px; margin-bottom: 10px; background: linear-gradient(135deg, rgba(255, 107, 107, 0.6), rgba(255, 193, 7, 0.6)); color: white; border: 1px solid rgba(0, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; transition: all 0.3s; text-transform: uppercase; letter-spacing: 0.5px;">
            ‚úì Show Heatmap
        </button>
        
        <!-- Legend (Compact) -->
        <div id="heatmapLegend" style="display: none; margin-bottom: 10px; padding: 8px; background: rgba(0, 100, 150, 0.2); border-radius: 4px; text-align: center; font-size: 9px; color: #94a3b8; border: 1px solid rgba(0, 255, 255, 0.1);">
            <div style="display: flex; justify-content: space-around; gap: 4px;">
                <div><span style="display: inline-block; width: 10px; height: 10px; background: #ff0000; border-radius: 2px; margin-right: 3px; vertical-align: middle;"></span>High</div>
                <div><span style="display: inline-block; width: 10px; height: 10px; background: #ffff00; border-radius: 2px; margin-right: 3px; vertical-align: middle;"></span>Med</div>
                <div><span style="display: inline-block; width: 10px; height: 10px; background: #00ff00; border-radius: 2px; margin-right: 3px; vertical-align: middle;"></span>Low</div>
            </div>
        </div>
        
        <!-- Stats (Hidden by default) -->
        <div id="heatmapComparisonStats" style="display: none; padding: 8px; background: rgba(71, 85, 105, 0.15); border: 1px solid rgba(71, 85, 105, 0.25); border-radius: 4px; font-size: 9px; max-height: 120px; overflow-y: auto; color: #94a3b8;"></div>
        </div>
    </div>
    
    <div id="governorateValuesList-top" style="position: fixed; top: 0; left: 0; right: 0; width: 100%; height: auto; max-height: none; display: none; flex-direction: row; overflow-x: auto; overflow-y: hidden; gap: 12px; padding: 12px 20px; background: rgba(10, 15, 30, 0.4); backdrop-filter: blur(8px); border-bottom: 1px solid rgba(0, 255, 255, 0.2); z-index: 2000; margin: 0; border: none; border-radius: 0; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);">
    </div>
    
    <script src="translations.js"></script>
    <script src="script.js"></script>
</body>
</html>
