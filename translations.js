// Language Translations for Earth 3D Map (English, French, Arabic)
const translations = {
    en: {
        // Toolbar & Navigation
        satellite: 'Satellite',
        terrain: 'Terrain',
        language: 'Language',
        
        // Layers Control
        layers: 'Layers',
        countryBorders: 'Country Borders',
        countryLabels: 'Country Labels',
        cityLabels: 'City Labels',
        imageryOpacity: 'Imagery Opacity',
        
        // Bookmarks
        bookmarks: 'Bookmarks',
        saveCurrentView: 'ğŸ’¾ Save Current View',
        
        // Heatmap Panel
        dataHeatmap: 'Data Heatmap ğŸ”¥',
        selectCountries: 'SELECT COUNTRIES:',
        selectMetric: 'Select Metric:',
        heatmapOpacity: 'Heatmap Opacity:',
        showHeatmap: 'Show Heatmap',
        hideHeatmap: 'Hide Heatmap',
        low: 'Low',
        medium: 'Medium',
        high: 'High',
        comparisonStats: 'ğŸ“Š Comparison Stats:',
        
        // Energy Panel
        energyData: 'Energy Data',
        country: 'Country:',
        year: 'Year:',
        play: 'Play Animation',
        pause: 'Pause Animation',
        aiPredictionModel: 'AI PREDICTION MODEL',
        deterministicProjections: 'Deterministic mathematical projections based on historical trends, growth rates, and field-specific models. No randomness - results are consistent and reproducible.',
        modelsUsed: 'Models Used:',
        recalculatePredictions: 'ğŸ”„ Recalculate Predictions',
        calculated: 'Calculated:',
        
        // Stats Labels
        population: 'POPULATION',
        million: 'million',
        gdp: 'GDP',
        billionUSD: 'billion USD',
        energyConsumption: 'ENERGY CONSUMPTION',
        mtep: 'MTEP',
        oilProduction: 'OIL PRODUCTION',
        millionBarrels: 'M barrels',
        gasProduction: 'GAS PRODUCTION',
        billionCubicMeters: 'billion mÂ³',
        electricityProduction: 'ELECTRICITY PRODUCTION',
        twh: 'TWh',
        renewableEnergyShare: 'RENEWABLE ENERGY SHARE',
        percent: '%',
        oilReserves: 'OIL RESERVES',
        gasReserves: 'GAS RESERVES',
        energyImports: 'ENERGY IMPORTS',
        energyExports: 'ENERGY EXPORTS',
        co2Emissions: 'CO2 EMISSIONS',
        millionTonnes: 'M tonnes',
        investment: 'INVESTMENT',
        millionUSD: 'million USD',
        
        // Carousel
        energyProduction: 'ENERGY PRODUCTION',
        renewableTransition: 'RENEWABLE TRANSITION',
        energyBalance: 'ENERGY BALANCE',
        economicIndicators: 'ECONOMIC INDICATORS',
        
        // Countries
        tunisia: 'Tunisia',
        algeria: 'Algeria',
        libya: 'Libya',
        morocco: 'Morocco',
        
        // Messages
        loadingEarthMap: 'Loading Earth Map...',
        noCountriesSelected: 'No countries selected',
        selectAtLeastOneCountry: 'Please select at least one country to display heatmap',
        noDataAvailable: 'No data available',
        governorateDataNotLoaded: 'Governorate data not loaded yet',
        metricNotFound: 'Metric not found',
        
        // Metrics
        energy_consumption: 'Energy Consumption',
        oil_production: 'Oil Production',
        gas_production: 'Gas Production',
        electricity_production: 'Electricity Production',
        renewable_share: 'Renewable Share %',
        co2_emissions: 'CO2 Emissions',
        renewable_share_label: 'Renewable Energy Share',
    },
    ar: {
        // Toolbar & Navigation
        satellite: 'Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©',
        terrain: 'Ø§Ù„ØªØ¶Ø§Ø±ÙŠØ³',
        language: 'Ø§Ù„Ù„ØºØ©',
        
        // Layers Control
        layers: 'Ø§Ù„Ø·Ø¨Ù‚Ø§Øª',
        countryBorders: 'Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¨Ù„Ø§Ø¯',
        countryLabels: 'ØªØ³Ù…ÙŠØ§Øª Ø§Ù„Ø¯ÙˆÙ„',
        cityLabels: 'ØªØ³Ù…ÙŠØ§Øª Ø§Ù„Ù…Ø¯Ù†',
        imageryOpacity: 'Ø´ÙØ§ÙÙŠØ© Ø§Ù„ØµÙˆØ±',
        
        // Bookmarks
        bookmarks: 'Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©',
        saveCurrentView: 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„ÙŠ',
        
        // Heatmap Panel
        dataHeatmap: 'Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ© ğŸ”¥',
        selectCountries: 'Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„:',
        selectMetric: 'Ø§Ø®ØªØ± Ù…Ù‚ÙŠØ§Ø³:',
        heatmapOpacity: 'Ø´ÙØ§ÙÙŠØ© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ©:',
        showHeatmap: 'Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ©',
        hideHeatmap: 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ©',
        low: 'Ù…Ù†Ø®ÙØ¶',
        medium: 'Ù…ØªÙˆØ³Ø·',
        high: 'Ø¹Ø§Ù„ÙŠ',
        comparisonStats: 'ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©:',
        
        // Energy Panel
        energyData: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù‚Ø©',
        country: 'Ø§Ù„Ø¨Ù„Ø¯:',
        year: 'Ø§Ù„Ø³Ù†Ø©:',
        play: 'ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù…ØªØ­Ø±Ùƒ',
        pause: 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù…ØªØ­Ø±Ùƒ',
        aiPredictionModel: 'Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
        deterministicProjections: 'ØªÙˆÙ‚Ø¹Ø§Øª Ø±ÙŠØ§Ø¶ÙŠØ© Ø­ØªÙ…ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© ÙˆÙ…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ù†Ù…Ùˆ ÙˆØ§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø¬Ø§Ù„. Ø¨Ø¯ÙˆÙ† Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© - Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø«Ø§Ø¨ØªØ© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙƒØ±Ø§Ø±.',
        modelsUsed: 'Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:',
        recalculatePredictions: 'ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª',
        calculated: 'Ù…Ø­Ø³ÙˆØ¨:',
        
        // Stats Labels
        population: 'Ø§Ù„Ø³ÙƒØ§Ù†',
        million: 'Ù…Ù„ÙŠÙˆÙ†',
        gdp: 'Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù…Ø­Ù„ÙŠ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ',
        billionUSD: 'Ù…Ù„ÙŠØ§Ø± Ø¯ÙˆÙ„Ø§Ø±',
        energyConsumption: 'Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø·Ø§Ù‚Ø©',
        mtep: 'MTEP',
        oilProduction: 'Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù†ÙØ·',
        millionBarrels: 'Ù…Ù„ÙŠÙˆÙ† Ø¨Ø±Ù…ÙŠÙ„',
        gasProduction: 'Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ØºØ§Ø²',
        billionCubicMeters: 'Ù…Ù„ÙŠØ§Ø± Ù…Â³',
        electricityProduction: 'Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡',
        twh: 'TWh',
        renewableEnergyShare: 'Ø­ØµØ© Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ¬Ø¯Ø¯Ø©',
        percent: '%',
        oilReserves: 'Ø§Ø­ØªÙŠØ§Ø·ÙŠØ§Øª Ø§Ù„Ù†ÙØ·',
        gasReserves: 'Ø§Ø­ØªÙŠØ§Ø·ÙŠØ§Øª Ø§Ù„ØºØ§Ø²',
        energyImports: 'ÙˆØ§Ø±Ø¯Ø§Øª Ø§Ù„Ø·Ø§Ù‚Ø©',
        energyExports: 'ØµØ§Ø¯Ø±Ø§Øª Ø§Ù„Ø·Ø§Ù‚Ø©',
        co2Emissions: 'Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª Ø«Ø§Ù†ÙŠ Ø£ÙƒØ³ÙŠØ¯ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†',
        millionTonnes: 'Ù…Ù„ÙŠÙˆÙ† Ø·Ù†',
        investment: 'Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±',
        millionUSD: 'Ù…Ù„ÙŠÙˆÙ† Ø¯ÙˆÙ„Ø§Ø±',
        
        // Carousel
        energyProduction: 'Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø·Ø§Ù‚Ø©',
        renewableTransition: 'Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ¬Ø¯Ø¯Ø©',
        energyBalance: 'Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ø·Ø§Ù‚Ø©',
        economicIndicators: 'Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©',
        
        // Countries
        tunisia: 'ØªÙˆÙ†Ø³',
        algeria: 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±',
        libya: 'Ù„ÙŠØ¨ÙŠØ§',
        morocco: 'Ø§Ù„Ù…ØºØ±Ø¨',
        
        // Messages
        loadingEarthMap: 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø£Ø±Ø¶...',
        noCountriesSelected: 'Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø¯ÙˆÙ„',
        selectAtLeastOneCountry: 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¯ÙˆÙ„Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ©',
        noDataAvailable: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø©',
        governorateDataNotLoaded: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ø¨Ø¹Ø¯',
        metricNotFound: 'Ø§Ù„Ù…Ù‚ÙŠØ§Ø³ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯',
    },
    fr: {
        // Toolbar & Navigation
        satellite: 'Satellite',
        terrain: 'Terrain',
        language: 'Langue',
        
        // Layers Control
        layers: 'Couches',
        countryBorders: 'FrontiÃ¨res des pays',
        countryLabels: 'Ã‰tiquettes de pays',
        cityLabels: 'Ã‰tiquettes de villes',
        imageryOpacity: 'OpacitÃ© de l\'imagerie',
        
        // Bookmarks
        bookmarks: 'Signets',
        saveCurrentView: 'ğŸ’¾ Enregistrer la vue actuelle',
        
        // Heatmap Panel
        dataHeatmap: 'Carte thermique des donnÃ©es ğŸ”¥',
        selectCountries: 'SÃ‰LECTIONNER LES PAYS:',
        selectMetric: 'SÃ©lectionner une mÃ©trique:',
        heatmapOpacity: 'OpacitÃ© de la carte thermique:',
        showHeatmap: 'Afficher la carte thermique',
        hideHeatmap: 'Masquer la carte thermique',
        low: 'Faible',
        medium: 'Moyen',
        high: 'Ã‰levÃ©',
        comparisonStats: 'ğŸ“Š Statistiques de comparaison:',
        
        // Energy Panel
        energyData: 'DonnÃ©es Ã©nergÃ©tiques',
        country: 'Pays:',
        year: 'AnnÃ©e:',
        play: 'Lire l\'animation',
        pause: 'Pause animation',
        aiPredictionModel: 'MODÃˆLE DE PRÃ‰DICTION IA',
        deterministicProjections: 'Projections mathÃ©matiques dÃ©terministes basÃ©es sur les tendances historiques, les taux de croissance et les modÃ¨les spÃ©cifiques aux domaines. Aucun caractÃ¨re alÃ©atoire - les rÃ©sultats sont cohÃ©rents et reproductibles.',
        modelsUsed: 'ModÃ¨les utilisÃ©s:',
        recalculatePredictions: 'ğŸ”„ Recalculer les prÃ©dictions',
        calculated: 'CalculÃ©:',
        
        // Stats Labels
        population: 'POPULATION',
        million: 'million',
        gdp: 'PIB',
        billionUSD: 'milliards USD',
        energyConsumption: 'CONSOMMATION Ã‰NERGÃ‰TIQUE',
        mtep: 'MTEP',
        oilProduction: 'PRODUCTION DE PÃ‰TROLE',
        millionBarrels: 'M barils',
        gasProduction: 'PRODUCTION DE GAZ',
        billionCubicMeters: 'milliards mÂ³',
        electricityProduction: 'PRODUCTION D\'Ã‰LECTRICITÃ‰',
        twh: 'TWh',
        renewableEnergyShare: 'PART D\'Ã‰NERGIE RENOUVELABLE',
        percent: '%',
        oilReserves: 'RÃ‰SERVES DE PÃ‰TROLE',
        gasReserves: 'RÃ‰SERVES DE GAZ',
        energyImports: 'IMPORTATIONS Ã‰NERGÃ‰TIQUES',
        energyExports: 'EXPORTATIONS Ã‰NERGÃ‰TIQUES',
        co2Emissions: 'Ã‰MISSIONS DE CO2',
        millionTonnes: 'M tonnes',
        investment: 'INVESTISSEMENT',
        millionUSD: 'millions USD',
        
        // Carousel
        energyProduction: 'PRODUCTION Ã‰NERGÃ‰TIQUE',
        renewableTransition: 'TRANSITION Ã‰NERGÃ‰TIQUE',
        energyBalance: 'BILAN Ã‰NERGÃ‰TIQUE',
        economicIndicators: 'INDICATEURS Ã‰CONOMIQUES',
        
        // Countries
        tunisia: 'Tunisie',
        algeria: 'AlgÃ©rie',
        libya: 'Libye',
        morocco: 'Maroc',
        
        // Messages
        loadingEarthMap: 'Chargement de la carte terrestre...',
        noCountriesSelected: 'Aucun pays sÃ©lectionnÃ©',
        selectAtLeastOneCountry: 'Veuillez sÃ©lectionner au moins un pays pour afficher la carte thermique',
        noDataAvailable: 'Aucune donnÃ©e disponible',
        governorateDataNotLoaded: 'Les donnÃ©es gouvernorales n\'ont pas Ã©tÃ© chargÃ©es',
        metricNotFound: 'MÃ©trique non trouvÃ©e',
    }
};

// Current language (default: English)
let currentLanguage = 'en';

// Get translation by key
function t(key) {
    const result = translations[currentLanguage]?.[key] || translations['en']?.[key] || key;
    if (currentLanguage === 'ar' && !translations['ar']?.[key]) {
        console.warn(`âš ï¸ Missing Arabic translation for key: ${key}`);
    }
    return result;
}

// Change language
function setLanguage(lang) {
    console.log('ğŸ”¤ setLanguage called with:', lang);
    if (translations[lang]) {
        currentLanguage = lang;
        localStorage.setItem('appLanguage', lang);
        console.log('âœ“ currentLanguage set to:', currentLanguage);
        updateUILanguage();
        console.log(`âœ“ Language changed to: ${lang}`);
    } else {
        console.error('âŒ Language not found:', lang);
    }
}

// Update all UI text based on current language
function updateUILanguage() {
    console.log('ğŸŒ Translating UI to:', currentLanguage);
    
    // Update energy panel title
    const panelTitle = document.getElementById('panelTitle');
    if (panelTitle) {
        const country = document.getElementById('energyCountry')?.value || 'tunisia';
        const countryName = t(country);
        panelTitle.textContent = `${countryName} ${t('energyData')}`;
    }
    
    // Update country selector label
    const countrySelectorLabel = document.querySelector('#countrySelector label');
    if (countrySelectorLabel) {
        countrySelectorLabel.textContent = t('country');
    }
    
    // Update year selector label
    const yearSelectorLabel = document.querySelector('#yearSelector label');
    if (yearSelectorLabel) {
        yearSelectorLabel.textContent = t('year');
    }
    
    // Update play/pause buttons
    const playBtn = document.getElementById('playBtn');
    if (playBtn) playBtn.title = t('play');
    
    const pauseBtn = document.getElementById('pauseBtn');
    if (pauseBtn) pauseBtn.title = t('pause');
    
    // Update map style options
    const mapStyleSelect = document.getElementById('mapStyle');
    if (mapStyleSelect) {
        mapStyleSelect.options[0].textContent = t('satellite');
        mapStyleSelect.options[1].textContent = t('terrain');
    }
    
    // Update language selector options
    const langSelect = document.getElementById('languageSelector');
    if (langSelect) {
        langSelect.options[0].textContent = 'English';
        langSelect.options[1].textContent = 'FranÃ§ais';
        langSelect.options[2].textContent = 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
    }
    
    // Update layer control
    const layerControl = document.getElementById('layerControl');
    if (layerControl) {
        const h4 = layerControl.querySelector('h4');
        if (h4) h4.textContent = t('layers');
        
        const labels = layerControl.querySelectorAll('label');
        if (labels[0]) labels[0].innerHTML = `<input type="checkbox" id="toggleBorders" checked> ${t('countryBorders')}`;
        if (labels[1]) labels[1].innerHTML = `<input type="checkbox" id="toggleLabels" checked> ${t('countryLabels')}`;
        if (labels[2]) labels[2].innerHTML = `<input type="checkbox" id="toggleCities" checked> ${t('cityLabels')}`;
        
        const sliderLabel = layerControl.querySelector('.slider-control label');
        if (sliderLabel) sliderLabel.textContent = t('imageryOpacity');
    }
    
    // Update bookmarks panel
    const bookmarksPanel = document.getElementById('bookmarksPanel');
    if (bookmarksPanel) {
        const h4 = bookmarksPanel.querySelector('h4');
        if (h4) h4.textContent = t('bookmarks');
        
        const btn = bookmarksPanel.querySelector('button');
        if (btn) btn.textContent = t('saveCurrentView');
    }
    
    // Update visualization toggle button
    const vizBtn = document.getElementById('toggleMapViz');
    if (vizBtn) vizBtn.textContent = 'ğŸ“Š ' + t('energyProduction');
    
    // Update stat card labels
    const statCards = document.querySelectorAll('.stat-card');
    statCards.forEach((card, index) => {
        const label = card.querySelector('.stat-label');
        const unit = card.querySelector('.stat-unit');
        
        const keyMap = [
            ['population', 'million'],
            ['gdp', 'billionUSD'],
            ['energyConsumption', 'mtep'],
            ['oilProduction', 'millionBarrels'],
            ['gasProduction', 'billionCubicMeters'],
            ['electricityProduction', 'twh'],
            ['renewableEnergyShare', 'percent'],
            ['oilReserves', 'millionBarrels'],
            ['gasReserves', 'billionCubicMeters'],
            ['energyImports', 'mtep'],
            ['energyExports', 'mtep'],
            ['co2Emissions', 'millionTonnes'],
            ['investment', 'millionUSD']
        ];
        
        if (keyMap[index]) {
            if (label) label.textContent = t(keyMap[index][0]);
            if (unit) unit.textContent = t(keyMap[index][1]);
        }
    });
    
    // Update country options in dropdown
    const countrySelect = document.getElementById('energyCountry');
    if (countrySelect) {
        countrySelect.options[0].textContent = t('tunisia');
        countrySelect.options[1].textContent = t('algeria');
        countrySelect.options[2].textContent = t('morocco');
        countrySelect.options[3].textContent = t('libya');
    }
    
    // Update visualization panel if visible
    const vizPanel = document.getElementById('mapVisualization');
    if (vizPanel && !vizPanel.classList.contains('hidden')) {
        const header = vizPanel.querySelector('.viz-header h3');
        if (header) {
            const country = document.getElementById('energyCountry')?.value || 'tunisia';
            const countryName = t(country);
            header.innerHTML = `${countryName} ${t('energyData')} <span id="vizYear">${document.getElementById('vizYear')?.textContent || '2025'}</span>`;
        }
    }
    
    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        element.textContent = t(key);
    });
    
    // Update all placeholders with data-i18n-placeholder attribute
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        element.placeholder = t(key);
    });
    
    // Update select options
    document.querySelectorAll('[data-i18n-value]').forEach(element => {
        const key = element.getAttribute('data-i18n-value');
        element.textContent = t(key);
    });
    
    // Special handling for HTML direction (RTL for Arabic)
    if (currentLanguage === 'ar') {
        document.documentElement.dir = 'rtl';
        document.documentElement.lang = 'ar';
        document.body.style.direction = 'rtl';
    } else {
        document.documentElement.dir = 'ltr';
        document.documentElement.lang = currentLanguage;
        document.body.style.direction = 'ltr';
    }
    
    console.log(`âœ“ UI updated to ${currentLanguage}`);
}

// Load saved language on page load
function loadSavedLanguage() {
    const savedLang = localStorage.getItem('appLanguage') || 'en';
    currentLanguage = savedLang;
    const languageSelector = document.getElementById('languageSelector');
    if (languageSelector) {
        languageSelector.value = savedLang;
    }
    // Update UI with the saved language
    setTimeout(() => updateUILanguage(), 100);
}
